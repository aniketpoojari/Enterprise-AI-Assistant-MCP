# Guardrails Configuration

input_guardrails:
  # Prompt injection detection
  injection_detection:
    enabled: true
    confidence_threshold: 0.7
    use_llm_classifier: true

  # PII filtering
  pii_filter:
    enabled: true
    patterns:
      - ssn
      - credit_card
      - email
      - phone

  # Query validation
  query_validation:
    enabled: true
    max_query_length: 1000
    allowed_topics:
      - products
      - orders
      - customers
      - reviews
      - inventory
      - revenue
      - sales
      - analytics

output_guardrails:
  # SQL validation
  sql_validation:
    enabled: true
    blocked_operations:
      - DROP
      - DELETE
      - UPDATE
      - INSERT
      - ALTER
      - CREATE
      - TRUNCATE
      - EXEC
      - EXECUTE
    allowed_tables:
      - customers
      - products
      - orders
      - order_items
      - reviews
      - inventory_log

  # Data masking
  data_masking:
    enabled: true
    sensitive_columns:
      - email
      - phone
      - address
      - zip_code
    masking_char: "*"
    visible_chars: 3

  # Hallucination check
  hallucination_check:
    enabled: true
    confidence_threshold: 0.6
